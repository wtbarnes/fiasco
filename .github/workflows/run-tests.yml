name: Run tests

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]


jobs:
  test:
    uses: OpenAstronomy/github-actions-workflows/.github/workflows/tox.yml@v1
    with:
      posargs: '--dbase-download-dir ~/.chianti'
      toxdeps: "'tox<4' tox-pypi-filter"
      envs: |
        - macos: py38
        - macos: py310
        - windows: py38
        - windows: py310
        - linux: py38
        - linux: py39
        - linux: py310
        - linux: build_docs
          posargs: ''
          python-version: '3.10'
        - linux: pre-commit
          posargs: ''
      coverage: 'codecov'
      cache-path: ~/.chianti
      cache-key: chianti-${{ github.run_id }}
